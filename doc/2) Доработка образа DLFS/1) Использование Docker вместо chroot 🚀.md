 
–ù–∞ —ç—Ç–æ–º —ç—Ç–∞–ø–µ –≤—ã —É–∂–µ —Å–æ–±—Ä–∞–ª–∏ –ø–æ–ª–Ω–æ—Ü–µ–Ω–Ω—É—é –≤—Ä–µ–º–µ–Ω–Ω—É—é —Å–∏—Å—Ç–µ–º—É **DLFS** 
–û–±—ã—á–Ω–æ –¥–ª—è –ø—Ä–æ–¥–æ–ª–∂–µ–Ω–∏—è —Å–±–æ—Ä–∫–∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è `chroot` ‚Äî —ç—Ç–æ –∫–ª–∞—Å—Å–∏—á–µ—Å–∫–∏–π, –Ω–æ —Ä—É—á–Ω–æ–π –ø–æ–¥—Ö–æ–¥.  
–ú—ã –∂–µ –ø–æ–π–¥—ë–º –±–æ–ª–µ–µ —Å–æ–≤—Ä–µ–º—ë–Ω–Ω—ã–º –ø—É—Ç—ë–º –∏ –≤–æ—Å–ø–æ–ª—å–∑—É–µ–º—Å—è **Docker**, —Ç–∞–∫ –∫–∞–∫ –æ–Ω –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç:

- üß© –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫—É—é –∏–∑–æ–ª—è—Ü–∏—é
- üõ†Ô∏è –≥–∏–±–∫–æ—Å—Ç—å –≤ –Ω–∞—Å—Ç—Ä–æ–π–∫–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è
- ‚ö° –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–ª–æ—ë–≤
- ü§ñ —É–¥–æ–±–Ω—É—é –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—é —á–µ—Ä–µ–∑ Dockerfile
- üì¶ –ª—ë–≥–∫–æ–µ —Ä–∞—Å–ø—Ä–æ—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ –æ–±—Ä–∞–∑–æ–≤

> –í —ç—Ç–æ–º —Ä–∞–∑–¥–µ–ª–µ –º—ã —Ä–∞—Å—Å–º–æ—Ç—Ä–∏–º, **–∫–∞–∫ Docker –∏–∑–æ–ª–∏—Ä—É–µ—Ç —Å—Ä–µ–¥—É –Ω–∞ –ª–µ—Ç—É** –∏ —á–µ–º –æ–Ω –≤—ã–≥–æ–¥–Ω–æ –æ—Ç–ª–∏—á–∞–µ—Ç—Å—è –æ—Ç `chroot`.

---

## üß± Docker –∏ chroot: –°—Ä–∞–≤–Ω–µ–Ω–∏–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–µ–π

| –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å                                  | `chroot`  | `Docker` |
| -------------------------------------------- | --------- | -------- |
| üîÅ –ò–∑–æ–ª—è—Ü–∏—è –ø—Ä–æ—Ü–µ—Å—Å–æ–≤ (`PID namespace`)      | ‚ùå –ù–µ—Ç     | ‚úÖ –î–∞     |
| üåê –ò–∑–æ–ª—è—Ü–∏—è —Å–µ—Ç–∏ (`NET namespace`)           | ‚ùå –ù–µ—Ç     | ‚úÖ –î–∞     |
| üìÇ –ò–∑–æ–ª—è—Ü–∏—è –º–æ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–∏—è (`Mount namespace`) | ‚ùå –ù–µ—Ç     | ‚úÖ –î–∞     |
| üß∑ –ü–æ–¥–¥–µ—Ä–∂–∫–∞ OverlayFS                       | ‚ùå –ù–µ—Ç     | ‚úÖ –î–∞     |
| ‚öôÔ∏è –ê–≤—Ç–æ–º–æ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ `/proc`, `/sys`          | ‚ùå –í—Ä—É—á–Ω—É—é | ‚úÖ –ê–≤—Ç–æ   |
| üñ•Ô∏è –£—Å—Ç–∞–Ω–æ–≤–∫–∞ hostname                       | ‚ùå –í—Ä—É—á–Ω—É—é | ‚úÖ –ê–≤—Ç–æ   |
| üìÑ –ù–∞—Å—Ç—Ä–æ–π–∫–∞ `/etc/hosts`, `resolv.conf`     | ‚ùå –ù–µ—Ç     | ‚úÖ –î–∞     |

---

## üß¨ –ö–∞–∫ Docker –∏–∑–æ–ª–∏—Ä—É–µ—Ç —Å—Ä–µ–¥—É

### üóÇÔ∏è 1. OverlayFS

Docker –∏—Å–ø–æ–ª—å–∑—É–µ—Ç **—Å–ª–æ–∏—Å—Ç—É—é —Ñ–∞–π–ª–æ–≤—É—é —Å–∏—Å—Ç–µ–º—É**:

- `lowerdir` ‚Äî –±–∞–∑–æ–≤–∞—è —Å–∏—Å—Ç–µ–º–∞
- `upperdir` ‚Äî –∏–∑–º–µ–Ω–µ–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
- `workdir` ‚Äî —Ä–∞–±–æ—á–∞—è –æ–±–ª–∞—Å—Ç—å

üí° –≠—Ç–æ –æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç:

- üîê –ó–∞—â–∏—Ç—É –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω–æ–≥–æ rootfs
- ‚úèÔ∏è –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –ø—Ä–∞–≤–æ–∫ –±–µ–∑ –º–æ–¥–∏—Ñ–∏–∫–∞—Ü–∏–∏ –æ—Ä–∏–≥–∏–Ω–∞–ª–∞

---

### üìÇ 2. –í–∏—Ä—Ç—É–∞–ª—å–Ω—ã–µ —Ñ–∞–π–ª–æ–≤—ã–µ —Å–∏—Å—Ç–µ–º—ã

Docker —Å–∞–º –º–æ–Ω—Ç–∏—Ä—É–µ—Ç:

```
/proc ‚Üí proc  
/sys ‚Üí sysfs  
/dev ‚Üí tmpfs  
/dev/pts ‚Üí devpts  
/dev/shm ‚Üí tmpfs  
/run ‚Üí tmpfs
```

‚ùó –í `chroot` —ç—Ç–æ –¥–µ–ª–∞–µ—Ç—Å—è –≤—Ä—É—á–Ω—É—é:

```
mount -t proc proc $LFS/proc
mount -t sysfs sysfs $LFS/sys
mount --bind /dev $LFS/dev
```


---

–ò—Å—Ç–æ—Ä–∏—á–µ—Å–∫–∏ —Å–ª–æ–∂–∏–ª–æ—Å—å, —á—Ç–æ Linux —Ö—Ä–∞–Ω–∏—Ç —Å–ø–∏—Å–æ–∫ –ø—Ä–∏–º–æ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤—ã—Ö —Å–∏—Å—Ç–µ–º –≤ —Ñ–∞–π–ª–µ /etc/ mtab . –°–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–µ —è–¥—Ä–∞ —Ö—Ä–∞–Ω—è—Ç —ç—Ç–æ—Ç —Å–ø–∏—Å–æ–∫ –≤–Ω—É—Ç—Ä–∏ —Å–µ–±—è –∏ –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è—é—Ç –µ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é —á–µ—Ä–µ–∑ —Ñ–∞–π–ª–æ–≤—É—é —Å–∏—Å—Ç–µ–º—É /proc . –ß—Ç–æ–±—ã —É–¥–æ–≤–ª–µ—Ç–≤–æ—Ä—è—Ç—å —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è–º —É—Ç–∏–ª–∏—Ç, –∫–æ—Ç–æ—Ä—ã–µ –æ–∂–∏–¥–∞—é—Ç –Ω–∞–ª–∏—á–∏—è /etc/mtab, –≤ Docker –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–æ–∑–¥–∞–µ—Ç—Å—è —Å–∏–º–ª–∏–Ω–∫

```
bash-5.2# ls -al /etc/mtab
lrwxrwxrwx 1 0 0 12 May 18 20:20 /etc/mtab -> /proc/mounts
bash-5.2# 
```



---

### üßæ 3. DNS –∏ –∏–º—è —Ö–æ—Å—Ç–∞

Docker –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–æ–∑–¥–∞—ë—Ç:

- `/etc/hostname`
     
- `/etc/hosts`
    
- `/etc/resolv.conf`
    

‚ùó –í `chroot` —ç—Ç–æ –¥–µ–ª–∞–µ—Ç—Å—è –≤—Ä—É—á–Ω—É—é:

/etc/hostname 
```
bash-5.2# cat /etc/hostname 
dlfs
```

/etc/hosts
```
bash-5.2# cat /etc/hosts
127.0.0.1	localhost
::1	localhost ip6-localhost ip6-loopback
fe00::0	ip6-localnet
ff00::0	ip6-mcastprefix
ff02::1	ip6-allnodes
ff02::2	ip6-allrouters
```

/etc/resolv.conf 
```
bash-5.2# cat /etc/resolv.conf 
nameserver 8.8.8.8
nameserver 8.8.4.4
```

---

### üåç 4. –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ —Å—Ä–µ–¥—ã

Docker —Å–∞–º –∑–∞–¥–∞—ë—Ç –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ:

```text
HOSTNAME=dlfs
TERM=xterm
PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin
```

---

### üîß 5. –ü—Ä–æ—Å—Ç–æ—Ç–∞ –∑–∞–ø—É—Å–∫–∞

```
docker run -it --rm --name dlfs -v ./main/mnt/lfs/sources:/sources dlfs bash
```

üìå –ß—Ç–æ –≤—ã –ø–æ–ª—É—á–∞–µ—Ç–µ:

- üñ•Ô∏è –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –∑–∞–ø—É—Å–∫ `bash`
    
- üîí –ü–æ–ª–Ω—É—é –∏–∑–æ–ª—è—Ü–∏—é
    
- üîÑ –°–º–æ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ –æ–∫—Ä—É–∂–µ–Ω–∏–µ


---

## ‚öñÔ∏è –°—Ä–∞–≤–Ω–µ–Ω–∏–µ —Å chroot

–ó–∞–ø—É—Å–∫ —á–µ—Ä–µ–∑ `chroot` —Ç—Ä–µ–±—É–µ—Ç:

```
mount -t proc proc $LFS/proc
mount -t sysfs sysfs $LFS/sys
mount --bind /dev $LFS/dev

chroot $LFS /tools/bin/env -i \
    HOME=/root TERM="$TERM" PS1='(lfs chroot) \u:\w\$ ' \
    PATH=/bin:/usr/bin:/sbin:/usr/sbin \
    /tools/bin/bash --login
```

üìå –í Docker –≤—Å—ë —ç—Ç–æ –¥–µ–ª–∞–µ—Ç **–æ–¥–Ω–∞** –∫–æ–º–∞–Ω–¥–∞.

---

## ‚úÖ –í—ã–≤–æ–¥

–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ **Docker** –≤–º–µ—Å—Ç–æ `chroot`:

- üîê –û–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç –ª—É—á—à—É—é –∏–∑–æ–ª—è—Ü–∏—é
    
- ‚öôÔ∏è –ê–≤—Ç–æ–º–∞—Ç–∏–∑–∏—Ä—É–µ—Ç –ø—Ä–æ—Ü–µ—Å—Å—ã
    
- üßπ –ò–∑–±–∞–≤–ª—è–µ—Ç –æ—Ç —Ä—É—á–Ω–æ–π –Ω–∞—Å—Ç—Ä–æ–π–∫–∏

